{% extends 'layout/base.html.twig' %}

{% block bodyClass %}catalog-product-view{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .title {padding-bottom:1em;margin-bottom:2em;border-bottom:1px solid #DDD;}
        .title h1 {color:#ff671f;}
        .categories nav ul li .active {font-weight:bold;}
        .categories .category {border:1px solid #BBB;text-align:center;}
        .product-detail #unit_of_measure_id {margin-right:20px;}
        .product-detail .price { font-size: 24px;}
        .product-detail .block {display:block;}
        .product-detail .block.volume {color:#BBB;}
        .product-detail .add-to-cart {display:flex;width:260px;background-color:orange;padding:1em;border-radius:10px}
        .product-detail .add-to-cart input[type=text] {padding:10px;border-radius:10px;margin-right:10px;}
        .product-detail .add-to-orderlist {border-bottom:1px solid #DDD;border-top:1px solid #DDD;margin-top:1em;padding:1em;}
        .product-detail .prijs.price_item {display:inline-block;font-size:25px;font-weight:bold;}
        .product-price .select, .product-price .price {float:left;}
        .product-price .select select {height:40px;}
        .product-price:after {clear:both;content:'';display:block;margin-bottom:1em;}
        .no-gutter {padding:0;}
    </style>
{% endblock %}

{% block body %}
    <div class="container product">
        <div class="row title">
            {% if product %}
                <div class="col-md-3">
                    <a href="{{ path('category_index') }} ">Terug</a>
                </div>
                <div class="col-md-9">
                    <h1>{{ product.name|upper }}</h1>
                </div>
            {% else %}
                <div class="col-md-12">
                    <h1>Product niet gevonden</h1>
                </div>
            {% endif %}
        </div>
        <p class="row">
            {% if product %}
                <div class="col-md-3 categories">
                    {% if parentCategories %}
                        <nav>
                            <ul>
                                {% for parentCategory in parentCategories %}
                                    <li>
                                        <a href="{{ path('category_view', {'id': parentCategory.id }) }}" class="listing{% if product.category.id == parentCategory.id %} active{% endif %}">
                                            {{ parentCategory.name }}
                                            <span class="icon"><i class="fa fa-chevron-right"></i></span>
                                        </a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </nav>
                    {% endif %}
                </div>
                <div class="col-md-9">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="http://via.placeholder.com/250x250{# product.mainPicture #}" />
                        </div>
                        <div class="col-md-9">
                            <div class="product-detail content">
                                <p>
                                    <span class="block">
                                        {% if product.manufacturer %}
                                            <a href="#">{{ product.manufacturer.name }}</a>
                                        {% endif %}
                                    </span>
                                    <span class="block volume">Inhoud: {{ product.volume }}</span>
                                </p>
                                {% if app.user %}
                                    {{ form_start(form, {'action': path('cart_product_add', {"product_id" : product.id}), 'method' : 'POST'}) }}
                                        <div class="col-md-6 no-gutter">
                                            {{ form_widget(form.product_unit_of_measure) }}
                                        </div>
                                        <div class="col-md-6">
                                            <div class="product-price">
                                                <div class="price">
                                                    {% for productPrice in productPrices %}
                                                        <div class="prijs price_item" id="price_{{ productPrice.productUnitOfMeasureId }}">
                                                            {{ productPrice.productPrice|price }}
                                                        </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="add-to-cart">
                                            {{ form_widget(form.qty) }}
                                            <button>Bestel</button>
                                        </div>
                                        <div class="add-to-orderlist">
                                            <a href="#" onclick="addToOrderList();return false;">Toevoegen aan bestellijst</a>
                                        </div>
                                    {{ form_end(form) }}
                                {% else %}
                                    <a href="{{ path('account_login') }}" class="btn btn-icon-label">
                                        <span class="icon"><i class="fa fa-shopping-cart"></i></span>
                                        <span class="label">Login om het product te bestellen</span>
                                    </a>
                                {% endif %}
                                <p>
                                    {{ product.description }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            {% else %}
                <p>Het product dat je probeert te bekijken bestaat niet.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {{ parent() }}
    <script type="text/javascript">
        function addToOrderList() {
            alert('Actie');
        }

        $("#add_to_cart_form_product_unit_of_measure").change(function () {
            $(".price_item").hide();
            $("#price_" + $(this).find('option:selected').data('unit-of-measure-id')).show();
        });

        $("#add_to_cart_form_product_unit_of_measure").trigger("change");
    </script>
{% endblock %}
