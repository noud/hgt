{% extends 'layout/base.html.twig' %}

{% block bodyClass %}checkout-cart-index{% endblock %}

{% block body %}

    <div class="container">
        <h1 class="page-title">Winkelwagen</h1>
        {% if form.products %}
            {{ form_start(form) }}
            {% for product in form.products %}
                {% set cartProduct = product.vars.data %}
                <div class="row">
                    <div class="col-md-2">
                        <a href="{{ path('cart_product_remove', {'product_id': cartProduct.id}) }}">
                            <i class="fa fa-trash-alt"></i>
                        </a>
                        <a href="{{ path('product_view', {'product_id': cartProduct.product.id} ) }}">
                            {{ cartProduct.product.name }}
                        </a>
                    </div>
                    <div class="col-md-3">
                        {% if cartProduct.product.manufacturer %}
                            {{ cartProduct.product.manufacturer.name }}
                        {% endif %}
                    </div>
                    <div class="col-md-3">{{ cartProduct.product.volume }} | {{ cartProduct.unitOfMeasure.name }}</div>
                    <div class="col-md-2">{{ cartProduct.getRowTotal|price }}</div>
                    <div class="col-md-2">{{ form_widget(product) }}</div>
                </div>
            {% endfor %}
            <div class="row">
                <div class="col-md-2 col-md-offset-8">Totaalbedrag (excl. btw)</div>
                <div class="col-md-2">{{ cartTotal|price }}</div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <a href="{{ path('category_index') }}" class="btn">Verder winkelen</a>
                    <a href="#" onclick="updateCart(); return false;">Bijwerken</a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 col-md-offset-4">
                    <div>Opmerkingen:</div>
                    {{ form_widget(form.note) }}
                </div>
                <div class="col-md-4">
                    <div>Afleverdatum:</div>
                    {{ form_widget(form.delivery_date) }}
                    <div>Referentie:</div>
                    {{ form_widget(form.reference) }}
                </div>
                <div class="col-md-offset-8 col-md-4">
                    <a href="#" onclick="placeOrder(); return false;" class="btn">Plaats bestelling</a>
                </div>
            </div>
            {{ form_end(form) }}
        {% else %}
            <p>Er zitten nog geen producten in uw winkelwagen.</p>
            <p>Voeg eerst producten aan uw winkelwagen toe om een bestelling te kunnen plaatsen.</p>
        {% endif %}
    </div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        function updateCart() {
            $('#{{ form.vars.id }}_form_action').val('update');
            $('#{{ form.vars.id }}').submit();
            return false;
        }

        function placeOrder() {
            $('#{{ form.vars.id }}_form_action').val('finish');
            $('#{{ form.vars.id }}').submit();
            return false;
        }
    </script>
{% endblock %}
